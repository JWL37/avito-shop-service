# avito-shop-service

## Запуск сервиса 

Для запуска нужен докер. Использую многоступенчатую сборку докер-образа(shop-service) для экономия памяти 


В директории avito-shop-service нужно выполнить:

```shell
docker-compose up -d
```

## Линтер

Для запуска нужно скачать golangci-lint.

Запускать можно через утилиту make:

```shell
make lint
```

или запустить скрипт вручную

```shell
./run_lint.sh
```

## Юнит тесты

Моки генерировал через `mockgen`

### Запуск

Для запуска нужен сам go. 

Запускать можно через утилиту make:

```shell
make test
```

### Результат

Процент покрытия: **`total:                                                                          (statements)                    45.3%`**

## Интеграционные тесты

Для интеграционных тестов нужно подготовить окружение.По-хорошему это должен быть отдельный докер образ,на котором сервис запущен на порту отличном от порта настоящего.Эти тесты я писал впервые,поэтому при проектирование архитектуры приложения не предусмотрел,что мне нужно будет менять конфиги.Это моя ошибка.На будущее я бы сделал конфиги либо *yaml,либо *json формата и при запуске сервиса указывал бы флаг (prod,dev,test).Тогда можно спокойно разделять окружения для тестов и для прода.

В данный момент,чтобы показать ,что тесты работают нужно запускать приложение на основном конфиге.

### Запуск

Для запуска нужен сам go.И нужно запустить сам сервис в докере.

Запускать можно через утилиту make:

```shell
make intergation
```


### Результат
```
go test -v

=== RUN   TestBuyMerch
--- PASS: TestBuyMerch (0.01s)
=== RUN   TestSendCoins
--- PASS: TestSendCoins (0.04s)
PASS
ok      avito-shop-service/tests/integration    0.066s
```


## TODO

* добавить валидацию 

К сожалению, не хватило времени для реализации.Если говорить на словах,как бы я её сделал,то я рассматривал два варианта:

    1 воспользоваться готовым валидатором
    2 написать свою обвязку и поместить её в internal/lib/hadlers/validator.Аналогично я сделал пакет response.